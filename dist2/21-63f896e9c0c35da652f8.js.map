{"version":3,"sources":["webpack:///./src/Libs/Hoc/GetDataDouBan.jsx","webpack:///./src/pages/Movies/Components/List.scss?f976","webpack:///./src/Libs/Utils/doubanApi.js","webpack:///./src/pages/Movies/Components/List.scss","webpack:///./src/pages/Movies/Components/MoviesTabs.jsx","webpack:///./src/pages/Movies/Components/List.jsx"],"names":["__webpack_require__","f","g","p","A","e","__esModule","default","t","Component","_React$Component","_class2","_ref","_temp","_this","_ret","_ref2","_this2","this","_classCallCheck3","_len","arguments","length","args","Array","_key","_possibleConstructorReturn3","__proto__","_getPrototypeOf2","call","apply","concat","state","loadState","loading","error","errorMsg","isOk","getData","_asyncToGenerator3","_regenerator2","mark","_callee","reqkey","res","dbData","update_time","delayend","_ref3","callback","url","_ref3$delaytime","delaytime","_ref3$cachetime","cachetime","options","_objectWithoutProperties3","wrap","_context","prev","next","abrupt","delayStart","Date","now","setState","_qs2","stringify","params","db","req","where","equalsIgnoreCase","last","sent","time","success","_doubanApi2","_extends3","put","_delay2","data","message","stop","_inherits3","_createClass3","key","value","_react2","createElement","props","content","module","i","hmr","transform","insertInto","locals","exports","doubanApi","create","baseURL","AppConfig","doubanUrl","timeout","dataType","interceptors","response","use","obj","err","_typeof3","Object","prototype","toString","toLowerCase","msg","statusText","status","request","console","log","localStorage","removeItem","store","dispatch","push","version","sources","names","mappings","file","sourcesContent","sourceRoot","listitem","img","detail","title","info","nodata","m1eu","n","defineProperty","a","r","o","s","l","u","c","_react","m","d","MoviesTabs","contextConsumers","movieSelectKey","movies","renderContent","tab","match","_List2","handleTabClick","_this$props","movie","merge","scrollTop","scrollTopChange","setIn","set","_props","_tabs2","tabs","page","onTabClick","renderTabBar","DefaultTabBar","y","_reactRouterDom","_","v","h","_ContextRudex","E","List","getIn","_callee2","_movie","start","count","_context2","more","city","total","subjects","isInit","_x","handleScroll","viewport","setScrollTop","load","getBoundingClientRect","top","window","screen","height","clearTimeout","delay","setTimeout","scrollTopChangeBack","_this$props2","_this3","_LazyWarper2","onScroll","map","Link","to","id","className","style","backgroundImage","images","small","directors","name","genres","rating","average","ref","ele","_Loading2","loadingTitle","errorAction","onClick","defaultProps","Immutable"],"mappings":"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","file":"21-63f896e9c0c35da652f8.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport qs from \"qs\";\r\nimport doubanApi from \"Utils/doubanApi\";\r\nimport delay from \"Utils/delay\";\r\n\r\nconst cachetime = 1000 * 60 * 60;\r\nconst GetDataDouBan = Component =>\r\n    class extends React.Component {\r\n        state = {\r\n            loadState: {\r\n                loading: false,\r\n                error: false,\r\n                errorMsg: \"\",\r\n                isOk: false\r\n            }\r\n        };\r\n        getData = async ({ url, delaytime = 0, cachetime = cachetime, ...options } = {}, callback) => {\r\n            if (this.loading) {\r\n                return;\r\n            }\r\n            this.loading = true;\r\n            this.delayStart = Date.now();\r\n            this.setState({\r\n                loadState: {\r\n                    loading: true,\r\n                    error: false,\r\n                    errorMsg: \"\",\r\n                    isOk: false\r\n                }\r\n            });\r\n            let reqkey = url + qs.stringify(options.params);\r\n            let res;\r\n            let dbData = await db.req\r\n                .where(\"req\")\r\n                .equalsIgnoreCase(reqkey)\r\n                .last();\r\n            if (dbData) {\r\n                res = dbData.res;\r\n                let update_time = dbData.time;\r\n                if (update_time && (Date.now() - update_time > cachetime || !res.success)) {\r\n                    res = await doubanApi({ url, ...options });\r\n                    db.req.put({ req: reqkey, res, time: Date.now() });\r\n                }\r\n            } else {\r\n                res = await doubanApi({ url, ...options });\r\n                db.req.put({ req: reqkey, res, time: Date.now() });\r\n            }\r\n            let delayend = this.delayStart + delaytime - Date.now();\r\n            if (delayend > 0) {\r\n                await delay(delayend);\r\n            }\r\n            if (res.success) {\r\n                if (callback) {\r\n                    await callback(res.data);\r\n                }\r\n                this.setState({\r\n                    loadState: {\r\n                        loading: false,\r\n                        error: false,\r\n                        errorMsg: \"\",\r\n                        isOk: true\r\n                    }\r\n                });\r\n            } else {\r\n                this.setState({\r\n                    loadState: {\r\n                        loading: false,\r\n                        error: true,\r\n                        errorMsg: res.message,\r\n                        isOk: false\r\n                    }\r\n                });\r\n            }\r\n            this.loading = false;\r\n        };\r\n        render() {\r\n            return <Component {...this.props} {...this.state} getData={this.getData} />;\r\n        }\r\n    };\r\n\r\nexport default GetDataDouBan;\r\n","\nvar content = require(\"!!../../../../node_modules/.0.28.11@css-loader/index.js??ref--5-1!../../../../node_modules/.2.1.3@postcss-loader/lib/index.js!../../../../node_modules/.6.0.7@sass-loader/lib/loader.js!./List.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/.0.20.3@style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/.0.28.11@css-loader/index.js??ref--5-1!../../../../node_modules/.2.1.3@postcss-loader/lib/index.js!../../../../node_modules/.6.0.7@sass-loader/lib/loader.js!./List.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/.0.28.11@css-loader/index.js??ref--5-1!../../../../node_modules/.2.1.3@postcss-loader/lib/index.js!../../../../node_modules/.6.0.7@sass-loader/lib/loader.js!./List.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/**\r\n * Requests a URL, returning a promise.\r\n *\r\n * @param  {string} url       The URL we want to request\r\n * @param  {object} [options] The options we want to pass to \"fetch\"\r\n * @return {object}           An object containing either \"data\" or \"err\"\r\n */\r\nimport axios from \"axios\";\r\n/**\r\n * 请求拦截器\r\n *\r\n */\r\nlet doubanApi = axios.create({\r\n    baseURL: AppConfig.doubanUrl,\r\n    timeout: 5000,\r\n    dataType: \"json\"\r\n});\r\n\r\n/**\r\n * 响应拦截器\r\n */\r\ndoubanApi.interceptors.response.use(\r\n    response => {\r\n        // 对响应数据做点什么\r\n        let data = {\r\n            success: true,\r\n            data: response.data\r\n        };\r\n        return data;\r\n    },\r\n    error => {\r\n        // 对响应错误做点什么\r\n        let res = {};\r\n        if (error.response) {\r\n            let err = error.response;\r\n            let data = isJson(err.data) ? err.data : {};\r\n            res = {\r\n                message: data.message || data.msg || err.statusText,\r\n                status: err.status,\r\n                ...data\r\n            };\r\n        } else if (error.request) {\r\n            res.message = \"网络错误，请检查你的网络状态\";\r\n        } else {\r\n            console.log(\"Error\", error.message);\r\n        }\r\n        if (res.status == 401) {\r\n            localStorage.removeItem(\"authorization\");\r\n            store.dispatch(\"user/init\", {});\r\n        }\r\n        res.success = false;\r\n        console.log(res);\r\n        return res;\r\n    }\r\n);\r\n\r\nexport default doubanApi;\r\n\r\n//判断obj是否为json对象\r\nfunction isJson(obj) {\r\n    var isjson =\r\n        typeof obj == \"object\" && Object.prototype.toString.call(obj).toLowerCase() == \"[object object]\" && !obj.length;\r\n    return isjson;\r\n}\r\n","exports = module.exports = require(\"../../../../node_modules/.0.28.11@css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".List_listitem_q_SyT {\\n  display: flex;\\n  margin: 0;\\n  padding: 0.08rem 0.15rem;\\n  background: #fff;\\n  color: #000;\\n  border-bottom: 1px solid #f4f4f4; }\\n  .List_listitem_q_SyT .List_img_1qW7B {\\n    width: 0.8rem;\\n    height: 1.1rem;\\n    background-size: cover;\\n    background-position: center;\\n    margin: 0 0.1rem 0 0; }\\n  .List_listitem_q_SyT .List_detail_1ts-7 {\\n    flex: 1; }\\n  .List_listitem_q_SyT .List_title_3RhHk {\\n    font-size: 0.17rem;\\n    line-height: 0.22rem;\\n    height: auto; }\\n  .List_listitem_q_SyT .List_detail_1ts-7 {\\n    margin: 0.05rem 0; }\\n  .List_listitem_q_SyT .List_info_20Nl0 {\\n    display: block;\\n    color: #999;\\n    font-size: 0.13rem;\\n    line-height: 0.22rem;\\n    margin: 0.05rem 0 0; }\\n  .List_listitem_q_SyT .List_img_1qW7B + .List_detail_1ts-7 {\\n    margin: 0; }\\n    .List_listitem_q_SyT .List_img_1qW7B + .List_detail_1ts-7 .List_title_3RhHk {\\n      max-height: 0.44rem;\\n      overflow: hidden; }\\n    .List_listitem_q_SyT .List_img_1qW7B + .List_detail_1ts-7 .List_info_20Nl0 {\\n      margin: 0; }\\n\\n.List_nodata_1zLS_ {\\n  padding: 0.15rem 0;\\n  text-align: center;\\n  color: #666;\\n  font-size: 0.15rem; }\\n\", \"\", {\"version\":3,\"sources\":[\"E:/www/webpack4/src/pages/Movies/Components/List.scss\"],\"names\":[],\"mappings\":\"AAAA;EACE,cAAc;EACd,UAAU;EACV,yBAAyB;EACzB,iBAAiB;EACjB,YAAY;EACZ,iCAAiC,EAAE;EACnC;IACE,cAAc;IACd,eAAe;IACf,uBAAuB;IACvB,4BAA4B;IAC5B,qBAAqB,EAAE;EACzB;IACE,QAAQ,EAAE;EACZ;IACE,mBAAmB;IACnB,qBAAqB;IACrB,aAAa,EAAE;EACjB;IACE,kBAAkB,EAAE;EACtB;IACE,eAAe;IACf,YAAY;IACZ,mBAAmB;IACnB,qBAAqB;IACrB,oBAAoB,EAAE;EACxB;IACE,UAAU,EAAE;IACZ;MACE,oBAAoB;MACpB,iBAAiB,EAAE;IACrB;MACE,UAAU,EAAE;;AAElB;EACE,mBAAmB;EACnB,mBAAmB;EACnB,YAAY;EACZ,mBAAmB,EAAE\",\"file\":\"List.scss\",\"sourcesContent\":[\".listitem {\\n  display: flex;\\n  margin: 0;\\n  padding: 0.08rem 0.15rem;\\n  background: #fff;\\n  color: #000;\\n  border-bottom: 1px solid #f4f4f4; }\\n  .listitem .img {\\n    width: 0.8rem;\\n    height: 1.1rem;\\n    background-size: cover;\\n    background-position: center;\\n    margin: 0 0.1rem 0 0; }\\n  .listitem .detail {\\n    flex: 1; }\\n  .listitem .title {\\n    font-size: 0.17rem;\\n    line-height: 0.22rem;\\n    height: auto; }\\n  .listitem .detail {\\n    margin: 0.05rem 0; }\\n  .listitem .info {\\n    display: block;\\n    color: #999;\\n    font-size: 0.13rem;\\n    line-height: 0.22rem;\\n    margin: 0.05rem 0 0; }\\n  .listitem .img + .detail {\\n    margin: 0; }\\n    .listitem .img + .detail .title {\\n      max-height: 0.44rem;\\n      overflow: hidden; }\\n    .listitem .img + .detail .info {\\n      margin: 0; }\\n\\n.nodata {\\n  padding: 0.15rem 0;\\n  text-align: center;\\n  color: #666;\\n  font-size: 0.15rem; }\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"listitem\": \"List_listitem_q_SyT\",\n\t\"img\": \"List_img_1qW7B\",\n\t\"detail\": \"List_detail_1ts-7\",\n\t\"title\": \"List_title_3RhHk\",\n\t\"info\": \"List_info_20Nl0\",\n\t\"nodata\": \"List_nodata_1zLS_\"\n};","import React, { Component } from \"react\";\r\nimport { Tabs, WhiteSpace } from \"antd-mobile\";\r\nimport List from \"./List\";\r\n\r\nimport { contextConsumers } from \"Libs/ContextRudex\";\r\n@contextConsumers(state => ({\r\n    movieSelectKey: state.movieSelectKey,\r\n    movies: state.movies\r\n}))\r\nexport default class MoviesTabs extends Component {\r\n    renderContent = tab => {\r\n        let { match } = this.props;\r\n        return <List tab={tab} match={match} />;\r\n    };\r\n    // handleChange = tab => {\r\n    //     console.log(tab);\r\n    //     this.props.dispatch.set({\r\n    //         movieSelectKey: tab.key\r\n    //     });\r\n    // };\r\n    handleTabClick = tab => {\r\n        let { movies, movieSelectKey } = this.props;\r\n        console.log(\"tab\", tab);\r\n        if (movieSelectKey == tab.key) {\r\n            let movie = movies[tab.key];\r\n            movie = movie.merge({\r\n                scrollTop: 0,\r\n                scrollTopChange: true\r\n            });\r\n            this.props.dispatch.setIn([\"movies\", tab.key], movie);\r\n        } else {\r\n            this.props.dispatch.set({\r\n                movieSelectKey: tab.key\r\n            });\r\n        }\r\n    };\r\n    render() {\r\n        let { movieSelectKey, movies } = this.props;\r\n        const tabs = [\r\n            { title: \"正在上映\", key: \"movie/in_theaters\" },\r\n            // { title: \"新片榜\", key: \"movie/new_movies\" },\r\n            { title: \"即将上映\", key: \"movie/coming_soon\" },\r\n            { title: \"Top250\", key: \"movie/top250\" },\r\n            { title: \"北美票房榜\", key: \"movie/us_box\" }\r\n            // { title: \"口碑榜\", key: \"movie/weekly\" }\r\n        ];\r\n        return (\r\n            <Tabs\r\n                tabs={tabs}\r\n                page={movieSelectKey}\r\n                // onChange={this.handleChange}\r\n                onTabClick={this.handleTabClick}\r\n                renderTabBar={props => <Tabs.DefaultTabBar {...props} page={4} />}\r\n            >\r\n                {this.renderContent}\r\n            </Tabs>\r\n        );\r\n    }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport dayjs from \"dayjs\";\r\nimport LazyWarper from \"Components/Layout/LazyWarper\";\r\nimport Loading from \"Components/Layout/Loading\";\r\nimport styles from \"./List.scss\";\r\n\r\nimport { contextConsumers } from \"Libs/ContextRudex\";\r\nimport GetData from \"Hoc/GetDataDouBan\";\r\n@contextConsumers((state, props) => ({\r\n    movie: state.getIn([\"movies\", props.tab.key])\r\n}))\r\n@GetData\r\nexport default class List extends Component {\r\n    static defaultProps = {\r\n        movie: Immutable({\r\n            data: [],\r\n            total: 0,\r\n            start: 0,\r\n            count: 20,\r\n            more: true,\r\n            isInit: true,\r\n            scrollTop: 0,\r\n            scrollTopChange: false\r\n        })\r\n    };\r\n    componentDidMount() {\r\n        let { isInit } = this.props.movie;\r\n        if (isInit) {\r\n            this.getData();\r\n        }\r\n    }\r\n    getData = async () => {\r\n        let { tab, dispatch, movie } = this.props;\r\n        let { data, start, count, more } = movie;\r\n        if (!more) {\r\n            return;\r\n        }\r\n        this.props.getData(\r\n            {\r\n                url: tab.key,\r\n                params: {\r\n                    start,\r\n                    count,\r\n                    city: \"恩施\"\r\n                }\r\n            },\r\n            async res => {\r\n                movie = movie.merge({\r\n                    total: res.total,\r\n                    more: res.subjects.length < count ? false : true,\r\n                    start: start + count,\r\n                    isInit: false,\r\n                    data: movie.data.concat(res.subjects)\r\n                });\r\n                dispatch.setIn([\"movies\", tab.key], movie);\r\n                // this.setState({\r\n                //     total: res.total,\r\n                //     more: res.subjects.length < count ? false : true,\r\n                //     start: start + count,\r\n                //     data: data.concat(res.subjects),\r\n                //     isInit: false\r\n                // });\r\n            }\r\n        );\r\n    };\r\n    handleScroll = viewport => {\r\n        this.setScrollTop(viewport);\r\n        let { more } = this.props.movie;\r\n        if (!more) {\r\n            return;\r\n        }\r\n        let { error } = this.props.loadState;\r\n        if (error) {\r\n            return;\r\n        }\r\n        let { top } = this.load.getBoundingClientRect();\r\n        let height = window.screen.height;\r\n        if (top < height + 100) {\r\n            this.getData();\r\n        }\r\n    };\r\n    setScrollTop = viewport => {\r\n        let { tab } = this.props;\r\n        clearTimeout(this.delay);\r\n        this.delay = setTimeout(() => {\r\n            this.props.dispatch.setIn([\"movies\", tab.key, \"scrollTop\"], viewport.scrollTop);\r\n        }, 300);\r\n    };\r\n    scrollTopChangeBack = () => {\r\n        let { dispatch, tab, movie } = this.props;\r\n        movie = movie.merge({\r\n            scrollTopChange: false\r\n        });\r\n        dispatch.setIn([\"movies\", tab.key], movie);\r\n    };\r\n    render() {\r\n        let { match, loadState, movie } = this.props;\r\n        let { data, isInit, more, scrollTop, scrollTopChange } = movie;\r\n        return (\r\n            <LazyWarper\r\n                onScroll={this.handleScroll}\r\n                scrollTop={scrollTop}\r\n                scrollTopChange={scrollTopChange}\r\n                scrollTopChangeBack={this.scrollTopChangeBack}\r\n            >\r\n                {data.map(d => {\r\n                    return (\r\n                        <Link to={`/movies/${d.id}`} key={d.id} className={styles.listitem}>\r\n                            <div className={styles.img} style={{ backgroundImage: `url(${d.images.small})` }} />\r\n                            <div className={styles.detail}>\r\n                                <div className={styles.title}>{d.title}</div>\r\n                                <div className={styles.info}>\r\n                                    <div>\r\n                                        导演：{d.directors.map(d => {\r\n                                            return d.name + \"，\";\r\n                                        })}\r\n                                    </div>\r\n                                    <div>\r\n                                        类型：{d.genres.map(d => {\r\n                                            return d + \"，\";\r\n                                        })}\r\n                                    </div>\r\n                                    <div>评分：{d.rating.average}</div>\r\n                                </div>\r\n                            </div>\r\n                        </Link>\r\n                    );\r\n                })}\r\n                <div ref={ele => (this.load = ele)} />\r\n                <Loading\r\n                    {...loadState}\r\n                    loadingTitle={\"数据加载中\"}\r\n                    errorAction={<div onClick={this.getData}>{loadState.errorMsg}，点击重试！</div>}\r\n                >\r\n                    {!more && <div className={styles.nodata}>没有更多数据了</div>}\r\n                </Loading>\r\n            </LazyWarper>\r\n        );\r\n    }\r\n}\r\n"],"sourceRoot":""}