(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"8AX4":function(e,t,n){"use strict";function a(e){this.Valid=!1,this.ID15="",this.ID18="",this.Local="",null!=e&&this.SetCardNo(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=(e.name,e.title,e.ruleValue),r=e.message;if(n)return r=r||"请输入真实有效的身份证号",isNaN(1*t)?r:new a(t).IsValid()?void 0:r},a.prototype.SetCardNo=function(e){this.ID15="",this.ID18="",this.Local="";var t=void 0;if(18==(e=e.replace(" ","")).length){if(null==/^\d{17}(\d|x|X)$/.exec(e))return;t=e.toUpperCase()}else{if(null==/^\d{15}$/.exec(e))return;t=e.substr(0,6)+"19"+e.substr(6,9),t+=this.GetVCode(t)}this.Valid=this.CheckValid(t)},a.prototype.IsValid=function(){return this.Valid},a.prototype.GetBirthDate=function(){var e="";return this.Valid&&(e=this.GetBirthYear()+"-"+this.GetBirthMonth()+"-"+this.GetBirthDay()),e},a.prototype.GetBirthYear=function(){var e="";return this.Valid&&(e=this.ID18.substr(6,4)),e},a.prototype.GetBirthMonth=function(){var e="";return this.Valid&&(e=this.ID18.substr(10,2)),"0"==e.charAt(0)&&(e=e.charAt(1)),e},a.prototype.GetBirthDay=function(){var e="";return this.Valid&&(e=this.ID18.substr(12,2)),e},a.prototype.GetSex=function(){var e="";return this.Valid&&(e=this.ID18.charAt(16)%2),e},a.prototype.Get15=function(){var e="";return this.Valid&&(e=this.ID15),e},a.prototype.Get18=function(){var e="";return this.Valid&&(e=this.ID18),e},a.prototype.GetLocal=function(){var e="";return this.Valid&&(e=this.Local),e},a.prototype.GetVCode=function(e){for(var t=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1),n=new Array("1","0","X","9","8","7","6","5","4","3","2"),a=0,r=0;r<e.length;r++)a+=e.charAt(r)*t[r];return n[a%11]},a.prototype.CheckValid=function(e){if(this.GetVCode(e.substr(0,17))!=e.charAt(17))return!1;if(!this.IsDate(e.substr(6,8)))return!1;var t={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};return null!=t[parseInt(e.substr(0,2))]&&(this.ID18=e,this.ID15=e.substr(0,6)+e.substr(8,9),this.Local=t[parseInt(e.substr(0,2))],!0)},a.prototype.IsDate=function(e){var t=e.match(/^(\d{1,4})(\d{1,2})(\d{1,2})$/);if(null==t)return!1;var n=new Date(t[1],t[2]-1,t[3]);return n.getFullYear()==t[1]&&n.getMonth()+1==t[2]&&n.getDate()==t[3]}},"9p3o":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(r)return t instanceof Array?0==t.length?i=i||(a||n)+"不能为空":void 0:null==t||""==t?i=i||(a||n)+"不能为空":void 0}},EUqZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(r)return t&&""!=t&&!/^[\u0391-\uFFE5]+$/.test(t)?i=i||(a||n)+"必须输入中文":void 0}},K4PL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n("uB8n")),r=p(n("pRfh")),i=p(n("KDvK")),s=p(n("clYf")),l=p(n("KN1l")),u=p(n("G+8T")),o=p(n("p02J")),c=p(n("cLmd")),d=p(n("dAt5")),f=p(n("Fo7F"));n("dTC+");var h=p(n("cDcd"));function p(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t,n,p;return n=t=function(t){function n(e){(0,o.default)(this,n);var t=(0,d.default)(this,(n.__proto__||(0,u.default)(n)).call(this,e));p.call(t);var a={cover:e.cover,width:e.width,height:e.height};return t.state={attachments:[].concat(JSON.parse(e.value)),files:{},value:[],params:(0,l.default)({},a,e.params)},t}return(0,f.default)(n,t),(0,c.default)(n,[{key:"render",value:function(){var t=this.state,n=t.attachments,a=t.value;return h.default.createElement(e,(0,l.default)({},this.props,{onFileChange:this.handleFileChange,onDel:this.handleDel,size:this.size,attachments:n,value:a}))}}]),n}(h.default.Component),t.defaultProps={value:"[]",image:!0,maxsize:AppConfig.maxUploadSize||307200,width:AppConfig.imgUploadWidth||1e3,height:AppConfig.imgUploadHeight||1e3,cover:AppConfig.imgCover||!1},p=function(){var e,t,n=this;this.handleFileChange=function(e){for(var t=n.props.image,a=e.target.files||e.dataTransfer.files,r=0;r<a.length;r++)t&&"image/gif"!==a[r].type?n.handleImageUpload(a[r]):n.handleFileUpload(a[r])},this.handleFileUpload=(e=(0,s.default)(r.default.mark(function e(t){var a,s,l,u,o,c,d;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state,s=a.attachments,l=a.files,u=s.length,l[u]=t,o=URL.createObjectURL(t),s.push({name:t.name,size:t.size,type:t.type,state:1,bloburl:o}),n.setState({attachments:s,files:l}),(c=new FormData).append("file",t),e.next=10,Request("businessResources/oneUpload",{method:"post",data:c});case 10:(d=e.sent).success&&"false"!=d.success?(s[u].state=3,s[u].path=d.url):(s[u].state=2,i.default.info(d.message)),n.setState({attachments:s}),n.handleChange({attachments:s});case 14:case"end":return e.stop()}},e,n)})),function(t){return e.apply(this,arguments)}),this.handleImageUpload=(t=(0,s.default)(r.default.mark(function e(t){var a,l,u,o,c,d,f,h;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.maxsize,!(t.size<a)){e.next=3;break}return e.abrupt("return",n.handleFileUpload(t));case 3:l=n.state,u=l.attachments,o=l.files,c=u.length,o[c]=t,d=URL.createObjectURL(t),u.push({name:t.name,size:t.size,type:t.type,state:1,bloburl:d}),n.setState({attachments:u,files:o}),f=new Image,(h=new FileReader).readAsDataURL(t),h.onload=(0,s.default)(r.default.mark(function e(){var a;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=h.result,f.src=a,f.onload=(0,s.default)(r.default.mark(function e(){var a,s,l,o,d;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.convertImageToCanvas(f),s=a.toDataURL(),l=n.convertCanvasToBlob(s,t.type),(o=new FormData).append("file",l),e.next=7,Request("businessResources/base64ImageUploadByBinary",{method:"post",data:o});case 7:(d=e.sent).success?(u[c].state=3,u[c].path=d.data.map.url):(u[c].state=2,i.default.info(d.message)),n.setState({attachments:u}),n.handleChange({attachments:u});case 11:case"end":return e.stop()}},e,n)}));case 3:case"end":return e.stop()}},e,n)}));case 13:case"end":return e.stop()}},e,n)})),function(e){return t.apply(this,arguments)}),this.convertImageToCanvas=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.state.params,a=t.cover||!1,r=t.width||600,i=t.height||600,s=e.width,l=e.height,u=r/i,o=s/l,c=0,d=0,f=void 0,h=void 0,p=document.createElement("canvas");return a?(u>o?(f=r,h=r*l/s):(f=s*i/l,h=i),p.width=r,p.height=i,c=(r-f)/2,d=(i-h)/2):(u>o?f=(h=i)*o:h=(f=r)*l/s,p.width=f,p.height=h),p.getContext("2d").drawImage(e,0,0,e.width,e.height,c,d,f,h),p},this.convertCanvasToBlob=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n=e.split(",")[1];n=window.atob(n);for(var a=new Uint8Array(n.length),r=0;r<n.length;r++)a[r]=n.charCodeAt(r);return new Blob([a],{type:t})},this.handleDel=function(e){e.stopPropagation();var t=e.target.dataset.index,a=n.state,r=a.attachments,i=a.files;r.splice(t,1),delete i[t],n.setState({attachments:r,files:i}),n.handleChange({attachments:r})},this.handleChange=function(e){var t=e.attachments,r=void 0===t?n.state.attachments:t,i=n.props,s=i.onChange,l=i.field,u=i.name,o=i.isone,c=[];r.map(function(e){3!=e.state&&e.state||c.push({size:e.size,name:e.name,type:e.type,path:e.path})}),o?n.setState({attachments:[]}):n.setState({value:c}),s&&s(l&&(l.name||l.id)||u,(0,a.default)(c))},this.size=function(e){return e<1024?e+"B":e<1048576?(e/1024).toFixed(2)+"KB":e<1073741824?(e/1024/1024).toFixed(2)+"MB":e<1099511627776?(e/1024/1024/1024).toFixed(2)+"GB":e+"B"}},n}},P4CO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(!((r*=1)<1))return t&&t.length>r?i=i||(a||n)+"不能超过"+r+"个字符":void 0}},XeE4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n("sB3K")),r=f(n("9p3o")),i=f(n("P4CO")),s=f(n("mwpn")),l=f(n("EUqZ")),u=f(n("pwGg")),o=f(n("jfHX")),c=f(n("pbZe")),d=f(n("8AX4"));function f(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(e.rules){var n=e.rules.map(function(n){var f=(0,a.default)(n).filter(function(e){return"message"!==e}),h={value:t,name:e.name,title:e.title,ruleValue:n[f[0]],message:n.message},p=!1;switch(f[0]){case"required":p=(0,r.default)(h);break;case"max":p=(0,i.default)(h);break;case"min":p=(0,s.default)(h);break;case"chinese":p=(0,l.default)(h);break;case"english":p=(0,u.default)(h);break;case"number":p=(0,o.default)(h);break;case"ennum":p=(0,c.default)(h);break;case"cardno":p=(0,d.default)(h)}return p});if((n=n.filter(function(e){return!1!==e&&void 0!==e})).length>0)return n}}},aKuF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("XeE4"))&&a.__esModule?a:{default:a};t.default=function(e,t){var n=[];return e.map(function(e){return(0,r.default)(e,t[e.name])}).map(function(e){e&&(n=n.concat(e))}),n}},jfHX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(r)return t&&""!=t&&!/^[0-9]+$/.test(t)?i=i||(a||n)+"只能输入数字":void 0}},l8sP:function(e,t,n){(t=e.exports=n("3G5m")(!0)).push([e.i,".SelectUserCpt_steps_3WiGr {\n  padding: 0.1rem;\n  background: #fff; }\n\n.SelectUserCpt_addBtn_1aRGR,\n.SelectUserCpt_avatar_3-xDo {\n  display: inline-block;\n  width: 0.54rem;\n  height: 0.54rem;\n  font-size: 0.4rem;\n  border-radius: 0.54rem;\n  line-height: 0.54rem;\n  overflow: hidden;\n  background: #f2f2f2;\n  color: #ccc;\n  text-align: center;\n  margin: 0.04rem; }\n\n.SelectUserCpt_avatar_3-xDo {\n  background: #108ee9;\n  font-size: 0.16rem;\n  color: #fff; }\n\n.SelectUserCpt_iconfont_1j6Yu {\n  line-height: 0.54rem;\n  font-size: 0.2rem;\n  width: 0.2rem;\n  color: #ccc;\n  display: inline-block;\n  height: 0.54rem;\n  overflow: hidden;\n  text-align: center;\n  margin: 0.05rem 0; }\n","",{version:3,sources:["E:/www/webpack4/src/Libs/Components/FormTable/SelectUserCpt.scss"],names:[],mappings:"AAAA;EACE,gBAAgB;EAChB,iBAAiB,EAAE;;AAErB;;EAEE,sBAAsB;EACtB,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB,uBAAuB;EACvB,qBAAqB;EACrB,iBAAiB;EACjB,oBAAoB;EACpB,YAAY;EACZ,mBAAmB;EACnB,gBAAgB,EAAE;;AAEpB;EACE,oBAAoB;EACpB,mBAAmB;EACnB,YAAY,EAAE;;AAEhB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,cAAc;EACd,YAAY;EACZ,sBAAsB;EACtB,gBAAgB;EAChB,iBAAiB;EACjB,mBAAmB;EACnB,kBAAkB,EAAE",file:"SelectUserCpt.scss",sourcesContent:[".steps {\n  padding: 0.1rem;\n  background: #fff; }\n\n.addBtn,\n.avatar {\n  display: inline-block;\n  width: 0.54rem;\n  height: 0.54rem;\n  font-size: 0.4rem;\n  border-radius: 0.54rem;\n  line-height: 0.54rem;\n  overflow: hidden;\n  background: #f2f2f2;\n  color: #ccc;\n  text-align: center;\n  margin: 0.04rem; }\n\n.avatar {\n  background: #108ee9;\n  font-size: 0.16rem;\n  color: #fff; }\n\n.iconfont {\n  line-height: 0.54rem;\n  font-size: 0.2rem;\n  width: 0.2rem;\n  color: #ccc;\n  display: inline-block;\n  height: 0.54rem;\n  overflow: hidden;\n  text-align: center;\n  margin: 0.05rem 0; }\n"],sourceRoot:""}]),t.locals={steps:"SelectUserCpt_steps_3WiGr",addBtn:"SelectUserCpt_addBtn_1aRGR",avatar:"SelectUserCpt_avatar_3-xDo",iconfont:"SelectUserCpt_iconfont_1j6Yu"}},mwpn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(!((r*=1)<1))return!t||t.length<r?i=i||(a||n)+"不能少于"+r+"个字符":void 0}},pbZe:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(r)return t&&""!=t&&!/^[0-9a-zA-Z]*$/.test(t)?i=i||(a||n)+"只能输入字母或者数字":void 0}},pwGg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.name,a=e.title,r=e.ruleValue,i=e.message;if(r)return t&&""!=t&&!/^[a-zA-Z]*$/.test(t)?i=i||(a||n)+"必须输入英文字母":void 0}},rPIf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,i,s=y(n("nbCY")),l=y(n("KDvK")),u=y(n("G+8T")),o=y(n("p02J")),c=y(n("cLmd")),d=y(n("dAt5")),f=y(n("Fo7F")),h=y(n("glBr"));n("ZsLX"),n("dTC+"),n("bCZg");var p=n("cDcd"),m=y(p),v=n("8LOv"),g=y(n("APrv")),A=y(n("fqwA")),C=y(n("v3FK")),B=n("rRcN"),b=y(n("Tfgt"));function y(e){return e&&e.__esModule?e:{default:e}}var w=h.default.Item,E=(0,B.contextConsumers)(function(e){return{query:e.query,userlists:e.getIn(["userList",localStorage.organizationId])}})(a=(0,v.withRouter)((i=r=function(e){function t(){var e,n,a,r;(0,o.default)(this,t);for(var i=arguments.length,s=Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=a=(0,d.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(s))),a.handleShowOrgCpt=function(){var e=a.props,t=e.match,n=e.history,r=e.name;n.push(t.url+"?"+r+"=true")},a.handleUserListClick=function(e){var t=a.props,n=t.name,r=t.value,i=t.onChange;if(t.single)return i(n,[e.userId]),void window.history.back();var s=r.length;if(s>0&&r[s-1]==e.userId)return l.default.info("该人员与前一人员是同一人");i(n,r=r.concat([e.userId])),window.history.back()},a.handleSelect=function(e){var t=a.props,n=t.name;(0,t.onChange)(n,e),window.history.back()},a.handleDelItem=function(e){var t=a.props,n=t.name,r=t.value,i=t.onChange,s=e.target.dataset.index;r.splice(s,1),i(n,r)},r=n,(0,d.default)(a,r)}return(0,f.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){this.props.userlists||this.props.dispatch.callBack(b.default)}},{key:"render",value:function(){var e=this,t=this.props,n=t.query,a=t.userlists,r=void 0===a?$arr:a,i=t.title,s=t.name,l=t.value,u=t.single,o=t.multiple,c=t.step;o=!u&&o;var d=l.map(function(e){return r.find(function(t){return t.userId==e})});return m.default.createElement(h.default,null,m.default.createElement(w,null,i,"(",d.length,"人)"),m.default.createElement("div",{className:C.default.steps},d.map(function(t,n){return[m.default.createElement("div",{key:n,className:C.default.avatar,"data-index":n,onClick:e.handleDelItem},t.personname),c&&m.default.createElement(_,null)]}),m.default.createElement("div",{className:C.default.addBtn,onClick:this.handleShowOrgCpt},"+")),n[s]&&m.default.createElement(k,{selectedKeys:l,multiple:o,onClickUser:this.handleUserListClick,onSelect:this.handleSelect}))}}]),t}(p.Component),r.defaultProps={step:!1,single:!1,multiple:!0,value:$arr},a=i))||a)||a;t.default=E;var _=function(){return m.default.createElement("div",{className:C.default.iconfont},m.default.createElement("i",{className:"iconfont icon-iconfontjiantou "}))},k=function(e){var t=e.onClickUser,n=e.onSelect,a=e.multiple,r=e.selectedKeys;return m.default.createElement(A.default,{onClickUser:t,selectedKeys:r,multiple:a},function(e,t){return m.default.createElement(s.default,{mode:"light",icon:m.default.createElement(g.default,null),rightContent:m.default.createElement("div",{onClick:function(){return n(e,t)}},"确定")},"选择人员")})}},v3FK:function(e,t,n){var a=n("l8sP");"string"==typeof a&&(a=[[e.i,a,""]]);n("DkTI")(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)}}]);